{"title":"DataGridView常用操作","uid":"cc26a2e6e1a0489e6526665c276705dd","slug":"DataGridView常用操作","date":"2025-07-29T09:26:07.000Z","updated":"2025-07-29T09:30:18.760Z","comments":true,"path":"api/articles/DataGridView常用操作.json","keywords":null,"cover":null,"content":"<h1 id=\"一、动态添加列\"><a href=\"#一、动态添加列\" class=\"headerlink\" title=\"一、动态添加列\"></a>一、动态添加列</h1><ol>\n<li><p>前置准备：清空旧列（可选）</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">datagridview1.Columns.Clear();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>动态添加各种列</p>\n<ul>\n<li>添加文本列（DataGridViewTextBoxColumn ）</li>\n</ul>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewTextBoxColumn datagridviewTextBoxColumn = <span class=\"keyword\">new</span> DataGridViewTextBoxColumn();</span><br><span class=\"line\">datagridviewTextBoxColumn.Name = <span class=\"string\">&quot;id&quot;</span>;</span><br><span class=\"line\">datagridviewTextBoxColumn.HeaderText = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">datagridviewTextBoxColumn.Visible = <span class=\"literal\">false</span>;</span><br><span class=\"line\">datagridviewTextBoxColumn.DataPropertyName = <span class=\"string\">&quot;id&quot;</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(textCol);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>添加复选框列（DataGridViewCheckBoxColumn）</li>\n</ul>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewCheckBoxColumn chkCol = <span class=\"keyword\">new</span> DataGridViewCheckBoxColumn();</span><br><span class=\"line\">chkCol.Name = <span class=\"string\">&quot;chkSelect&quot;</span>;</span><br><span class=\"line\">chkCol.HeaderText = <span class=\"string\">&quot;选择&quot;</span>;</span><br><span class=\"line\">chkCol.TrueValue = <span class=\"literal\">true</span>;</span><br><span class=\"line\">chkCol.FalseValue = <span class=\"literal\">false</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(chkCol);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>添加按钮列（DataGridViewButtonColumn）</li>\n</ul>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewButtonColumn btnCol = <span class=\"keyword\">new</span> DataGridViewButtonColumn ();</span><br><span class=\"line\">btnCol.Name = <span class=\"string\">&quot;btnAction&quot;</span>;</span><br><span class=\"line\">btnCol.HeaderText = <span class=\"string\">&quot;操作&quot;</span>;</span><br><span class=\"line\">btnCol.Text = <span class=\"string\">&quot;详情&quot;</span>;</span><br><span class=\"line\">btnCol.UseColumnTextForButtonValue = <span class=\"literal\">true</span>; <span class=\"comment\">// 显示文本</span></span><br><span class=\"line\">btnCol.Width = <span class=\"number\">80</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(btnCol);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>下拉框列（DataGridViewComboBoxColumn）</li>\n</ul>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewComboBoxColumn comboCol = <span class=\"keyword\">new</span> DataGridViewComboBoxColumn();</span><br><span class=\"line\">comboCol.Name = <span class=\"string\">&quot;cboStatus&quot;</span>;</span><br><span class=\"line\">comboCol.HeaderText = <span class=\"string\">&quot;状态&quot;</span>;</span><br><span class=\"line\">comboCol.Items.AddRange(<span class=\"string\">&quot;启用&quot;</span>,<span class=\"string\">&quot;禁用&quot;</span>,<span class=\"string\">&quot;审核中&quot;</span>);</span><br><span class=\"line\">comboCol.Width = <span class=\"number\">100</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(comboCol);</span><br></pre></td></tr></table></figure>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>✅ 可绑定数据源：<code>comboCol.DataSource = yourList; comboCol.DisplayMember = &quot;Name&quot;; comboCol.ValueMember = &quot;ID&quot;;</code></p></blockquote>\n<ul>\n<li>添加图像列（DataGridViewImageColumn）</li>\n</ul>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewImageColumn imgCol = <span class=\"keyword\">new</span> DataGridViewImageColumn();</span><br><span class=\"line\">imgCol.Name = <span class=\"string\">&quot;imgPhoto&quot;</span>;</span><br><span class=\"line\">imgCol.HeaderText = <span class=\"string\">&quot;头像&quot;</span>;</span><br><span class=\"line\">imgCol.ImageLayout = DataGridViewImageCellLayout.Zoom;</span><br><span class=\"line\">imgCol.width = <span class=\"number\">60</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(imgCol);</span><br></pre></td></tr></table></figure>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>🎯 为 <code>imgCol</code> 设置值时：</p></blockquote>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Rows[<span class=\"number\">0</span>].Cells[<span class=\"string\">&quot;imgPhoto&quot;</span>].Value = Image.FromFile(<span class=\"string\">&quot;path/to/image.jpg&quot;</span>);</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"二、绑定数据（Bind-Data）\"><a href=\"#二、绑定数据（Bind-Data）\" class=\"headerlink\" title=\"二、绑定数据（Bind Data）\"></a>二、绑定数据（Bind Data）</h1><p>绑定List数据源</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.DataSource = yourList;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、列设置（Column-Settings）\"><a href=\"#三、列设置（Column-Settings）\" class=\"headerlink\" title=\"三、列设置（Column Settings）\"></a>三、列设置（Column Settings）</h1><h3 id=\"1-设置列标题（Set-Column-Header-Text）\"><a href=\"#1-设置列标题（Set-Column-Header-Text）\" class=\"headerlink\" title=\"1. 设置列标题（Set Column Header Text）\"></a>1. 设置列标题（Set Column Header Text）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Columns[<span class=\"string\">&quot;columnName&quot;</span>].HeaderText = <span class=\"string\">&quot;显示名称&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-隐藏某列（Hide-Column）\"><a href=\"#2-隐藏某列（Hide-Column）\" class=\"headerlink\" title=\"2. 隐藏某列（Hide Column）\"></a>2. 隐藏某列（Hide Column）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Columns[<span class=\"string\">&quot;columnName&quot;</span>].Visible = <span class=\"literal\">false</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-设置列宽（Set-Column-Width）\"><a href=\"#3-设置列宽（Set-Column-Width）\" class=\"headerlink\" title=\"3. 设置列宽（Set Column Width）\"></a>3. 设置列宽（Set Column Width）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Columns[<span class=\"string\">&quot;columnName&quot;</span>].Width = <span class=\"number\">120</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-设置列只读（Make-Column-ReadOnly）\"><a href=\"#4-设置列只读（Make-Column-ReadOnly）\" class=\"headerlink\" title=\"4. 设置列只读（Make Column ReadOnly）\"></a>4. 设置列只读（Make Column ReadOnly）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Columns[<span class=\"string\">&quot;columnName&quot;</span>].ReadOnly = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"四、行设置（Row-Settings）\"><a href=\"#四、行设置（Row-Settings）\" class=\"headerlink\" title=\"四、行设置（Row Settings）\"></a>四、行设置（Row Settings）</h1><h3 id=\"1-设置行高（Row-Height）\"><a href=\"#1-设置行高（Row-Height）\" class=\"headerlink\" title=\"1. 设置行高（Row Height）\"></a>1. 设置行高（Row Height）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.RowTemplate.Height = <span class=\"number\">40</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-设置行背景色（Set-Row-BackColor）\"><a href=\"#2-设置行背景色（Set-Row-BackColor）\" class=\"headerlink\" title=\"2. 设置行背景色（Set Row BackColor）\"></a>2. 设置行背景色（Set Row BackColor）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Rows[i].DefaultCellStyle.BackColor = Color.LightBlue;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-设置选中行颜色（Selected-Row-Color）\"><a href=\"#3-设置选中行颜色（Selected-Row-Color）\" class=\"headerlink\" title=\"3. 设置选中行颜色（Selected Row Color）\"></a>3. 设置选中行颜色（Selected Row Color）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.DefaultCellStyle.SelectionBackColor = Color.Orange;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"五、获取数据（Get-Data）\"><a href=\"#五、获取数据（Get-Data）\" class=\"headerlink\" title=\"五、获取数据（Get Data）\"></a>五、获取数据（Get Data）</h1><ol>\n<li>获取选中行（Get Selected Row）</li>\n</ol>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewRow selectedRow = datagridview1.CurrentRow;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>获取某列值（Get Cell Value）</li>\n</ol>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">string</span> columnValue = datagridview1.CurrentRow.Cells[<span class=\"string\">&quot;columnName&quot;</span>].Value.ToString();</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>遍历所有行（Loop All Rows）</li>\n</ol>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">foreach</span>(DataGridViewRow row <span class=\"keyword\">in</span> datagridview1.rows)&#123;</span><br><span class=\"line\">\t <span class=\"keyword\">var</span> <span class=\"keyword\">value</span> = row.Cells[<span class=\"string\">&quot;columnName&quot;</span>].Value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"六、添加-删除行（Add-Delete-Rows）\"><a href=\"#六、添加-删除行（Add-Delete-Rows）\" class=\"headerlink\" title=\"六、添加&#x2F;删除行（Add&#x2F;Delete Rows）\"></a>六、添加&#x2F;删除行（Add&#x2F;Delete Rows）</h2><h3 id=\"1-添加空行（Add-Empty-Row）\"><a href=\"#1-添加空行（Add-Empty-Row）\" class=\"headerlink\" title=\"1. 添加空行（Add Empty Row）\"></a>1. 添加空行（Add Empty Row）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Rows.Add();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-添加带数据的行（Add-Row-with-Values）\"><a href=\"#2-添加带数据的行（Add-Row-with-Values）\" class=\"headerlink\" title=\"2. 添加带数据的行（Add Row with Values）\"></a>2. 添加带数据的行（Add Row with Values）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataGridView1.Rows.Add(<span class=\"string\">&quot;值1&quot;</span>, <span class=\"string\">&quot;值2&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-删除选中行（Delete-Selected-Row）\"><a href=\"#3-删除选中行（Delete-Selected-Row）\" class=\"headerlink\" title=\"3. 删除选中行（Delete Selected Row）\"></a>3. 删除选中行（Delete Selected Row）</h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (dataGridView1.CurrentRow != <span class=\"literal\">null</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    dataGridView1.Rows.Remove(dataGridView1.CurrentRow);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"七、控件交互（Events）\"><a href=\"#七、控件交互（Events）\" class=\"headerlink\" title=\"七、控件交互（Events）\"></a>七、控件交互（Events）</h2><ol>\n<li>单元格点击事件（CellClick）</li>\n</ol>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">dataGridView1_CellClick</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DataGridViewCellEventArgs e</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> <span class=\"keyword\">value</span> = dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>编辑后事件（CellValueChanged）</li>\n</ol>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">dataGridView1_CellValueChanged</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DataGridViewCellEventArgs e</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    MessageBox.Show(<span class=\"string\">&quot;值被修改！&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"八、复选框列（Checkbox-Column）\"><a href=\"#八、复选框列（Checkbox-Column）\" class=\"headerlink\" title=\"八、复选框列（Checkbox Column）\"></a>八、复选框列（Checkbox Column）</h2><ol>\n<li><p>添加复选框列</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewCheckBoxColumn checkColumn = <span class=\"keyword\">new</span> DataGridViewCheckBoxColumn();</span><br><span class=\"line\">checkColumn.Name = <span class=\"string\">&quot;Check&quot;</span>;</span><br><span class=\"line\">checkColumn.HeaderText = <span class=\"string\">&quot;选择&quot;</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(checkColumn);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>获取选中复选框行（Get Checked Rows）</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">foreach</span>(DataGridViewRow row <span class=\"keyword\">in</span> datagridview1.Rows)&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">bool</span> isChecked = Convert.ToBoolean(row.Cells[<span class=\"string\">&quot;Check&quot;</span>].Value);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(isChecked)&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// 执行操作</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"九、自定义按钮列（Button-Column）\"><a href=\"#九、自定义按钮列（Button-Column）\" class=\"headerlink\" title=\"九、自定义按钮列（Button Column）\"></a>九、自定义按钮列（Button Column）</h1><p>添加按钮列并处理点击事件：</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DataGridViewButtonColumn btn = <span class=\"keyword\">new</span> DataGridViewButtonColumn();</span><br><span class=\"line\">btn.Name = <span class=\"string\">&quot;Detail&quot;</span>;</span><br><span class=\"line\">btn.HeaderText = <span class=\"string\">&quot;操作&quot;</span>;</span><br><span class=\"line\">btn.Text = <span class=\"string\">&quot;详情&quot;</span>;</span><br><span class=\"line\">btn.UseColumnTextForButtonValue = <span class=\"literal\">true</span>;</span><br><span class=\"line\">dataGridView1.Columns.Add(btn);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">dataGridView1_CellContentClick</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DataGridViewCellEventArgs e</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dataGridView1.Columns[e.ColumnIndex].Name == <span class=\"string\">&quot;Detail&quot;</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        MessageBox.Show(<span class=\"string\">&quot;点击了详情&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"十、批量操作（Batch-Operations）\"><a href=\"#十、批量操作（Batch-Operations）\" class=\"headerlink\" title=\"十、批量操作（Batch Operations）\"></a>十、批量操作（Batch Operations）</h1><ol>\n<li><p>获取选中复选框的所有行数据（Get Checked Rows）</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;<span class=\"built_in\">int</span>&gt; idList = <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">int</span>&gt;();</span><br><span class=\"line\"><span class=\"keyword\">foreach</span>(DataGridViewRow row <span class=\"keyword\">in</span> dataGridView1.Rows)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(Convert.ToBoolean(row.Cells[<span class=\"string\">&quot;check&quot;</span>].Value) == <span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">\t\t\tidList.Add(Convert.ToInt32(row.Cells[<span class=\"string\">&quot;id&quot;</span>].Value));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>批量删除（Batch Delete）</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"built_in\">int</span> i = datagridview1.Rows.Count - <span class=\"number\">1</span>;i &gt;= <span class=\"number\">0</span>;i--)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(Convert.ToBoolean(row.Cells[<span class=\"string\">&quot;Check&quot;</span>].Value) == <span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">\t\tdatagridview1.Rows.removeAt(i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n","feature":true,"text":"一、动态添加列 前置准备：清空旧列（可选） 1datagridview1.Columns.Clear(); 动态添加各种列 添加文本列（DataGridView...","permalink":"/post/DataGridView常用操作","photos":[],"count_time":{"symbolsCount":"5.1k","symbolsTime":"5 mins."},"categories":[],"tags":[{"name":"Winform","slug":"Winform","count":1,"path":"api/tags/Winform.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0%E5%88%97\"><span class=\"toc-text\">一、动态添加列</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E7%BB%91%E5%AE%9A%E6%95%B0%E6%8D%AE%EF%BC%88Bind-Data%EF%BC%89\"><span class=\"toc-text\">二、绑定数据（Bind Data）</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81%E5%88%97%E8%AE%BE%E7%BD%AE%EF%BC%88Column-Settings%EF%BC%89\"><span class=\"toc-text\">三、列设置（Column Settings）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E8%AE%BE%E7%BD%AE%E5%88%97%E6%A0%87%E9%A2%98%EF%BC%88Set-Column-Header-Text%EF%BC%89\"><span class=\"toc-text\">1. 设置列标题（Set Column Header Text）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E9%9A%90%E8%97%8F%E6%9F%90%E5%88%97%EF%BC%88Hide-Column%EF%BC%89\"><span class=\"toc-text\">2. 隐藏某列（Hide Column）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E8%AE%BE%E7%BD%AE%E5%88%97%E5%AE%BD%EF%BC%88Set-Column-Width%EF%BC%89\"><span class=\"toc-text\">3. 设置列宽（Set Column Width）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E8%AE%BE%E7%BD%AE%E5%88%97%E5%8F%AA%E8%AF%BB%EF%BC%88Make-Column-ReadOnly%EF%BC%89\"><span class=\"toc-text\">4. 设置列只读（Make Column ReadOnly）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9B%9B%E3%80%81%E8%A1%8C%E8%AE%BE%E7%BD%AE%EF%BC%88Row-Settings%EF%BC%89\"><span class=\"toc-text\">四、行设置（Row Settings）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E8%AE%BE%E7%BD%AE%E8%A1%8C%E9%AB%98%EF%BC%88Row-Height%EF%BC%89\"><span class=\"toc-text\">1. 设置行高（Row Height）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E8%AE%BE%E7%BD%AE%E8%A1%8C%E8%83%8C%E6%99%AF%E8%89%B2%EF%BC%88Set-Row-BackColor%EF%BC%89\"><span class=\"toc-text\">2. 设置行背景色（Set Row BackColor）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E8%AE%BE%E7%BD%AE%E9%80%89%E4%B8%AD%E8%A1%8C%E9%A2%9C%E8%89%B2%EF%BC%88Selected-Row-Color%EF%BC%89\"><span class=\"toc-text\">3. 设置选中行颜色（Selected Row Color）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%94%E3%80%81%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%EF%BC%88Get-Data%EF%BC%89\"><span class=\"toc-text\">五、获取数据（Get Data）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%AD%E3%80%81%E6%B7%BB%E5%8A%A0-%E5%88%A0%E9%99%A4%E8%A1%8C%EF%BC%88Add-Delete-Rows%EF%BC%89\"><span class=\"toc-text\">六、添加&#x2F;删除行（Add&#x2F;Delete Rows）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E6%B7%BB%E5%8A%A0%E7%A9%BA%E8%A1%8C%EF%BC%88Add-Empty-Row%EF%BC%89\"><span class=\"toc-text\">1. 添加空行（Add Empty Row）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E6%B7%BB%E5%8A%A0%E5%B8%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%8C%EF%BC%88Add-Row-with-Values%EF%BC%89\"><span class=\"toc-text\">2. 添加带数据的行（Add Row with Values）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E5%88%A0%E9%99%A4%E9%80%89%E4%B8%AD%E8%A1%8C%EF%BC%88Delete-Selected-Row%EF%BC%89\"><span class=\"toc-text\">3. 删除选中行（Delete Selected Row）</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%83%E3%80%81%E6%8E%A7%E4%BB%B6%E4%BA%A4%E4%BA%92%EF%BC%88Events%EF%BC%89\"><span class=\"toc-text\">七、控件交互（Events）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%AB%E3%80%81%E5%A4%8D%E9%80%89%E6%A1%86%E5%88%97%EF%BC%88Checkbox-Column%EF%BC%89\"><span class=\"toc-text\">八、复选框列（Checkbox Column）</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B9%9D%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%89%E9%92%AE%E5%88%97%EF%BC%88Button-Column%EF%BC%89\"><span class=\"toc-text\">九、自定义按钮列（Button Column）</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8D%81%E3%80%81%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C%EF%BC%88Batch-Operations%EF%BC%89\"><span class=\"toc-text\">十、批量操作（Batch Operations）</span></a></li></ol>","author":{"name":"Felix Still","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"Documenting my journey in Android native and WinForms development. Tutorials, experiments, and practical coding experiences.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Entity Framework实现具体业务功能","uid":"cefa2fc37006a5e3cbed334f7a0a3e71","slug":"Entity Framework实现具体业务功能","date":"2025-07-29T09:26:07.000Z","updated":"2025-07-29T09:59:57.073Z","comments":true,"path":"api/articles/Entity Framework实现具体业务功能.json","keywords":null,"cover":null,"text":"下面是一个 WinForms + Entity Framework（EF）实现具体业务功能 的完整参考，包括： 🔹 数据绑定到 DataGridView 🔹 使...","permalink":"/post/Entity Framework实现具体业务功能","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Entity Framework","slug":"Entity-Framework","count":3,"path":"api/tags/Entity-Framework.json"}],"author":{"name":"Felix Still","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"Documenting my journey in Android native and WinForms development. Tutorials, experiments, and practical coding experiences.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Entity Framework常用操作","uid":"0adec41aad666bb9dbc2e935ddaf42e9","slug":"Entity Framework常用操作","date":"2025-07-29T09:26:07.000Z","updated":"2025-07-29T09:59:35.878Z","comments":true,"path":"api/articles/Entity Framework常用操作.json","keywords":null,"cover":null,"text":"一、基础操作（增删改查）▶ 添加数据（Create） 1234DB context = new DB()User user = new User {Name =...","permalink":"/post/Entity Framework常用操作","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Entity Framework","slug":"Entity-Framework","count":3,"path":"api/tags/Entity-Framework.json"}],"author":{"name":"Felix Still","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"Documenting my journey in Android native and WinForms development. Tutorials, experiments, and practical coding experiences.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}